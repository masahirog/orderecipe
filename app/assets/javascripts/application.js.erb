//= require rails-ujs
//= require jquery3
//= require activestorage
//= require cocoon
//= require turbolinks
//= require jquery-ui
//= require_tree .





$(document).on("turbolinks:before-cache", function() {
  if ($(".select2").length) {
    $('.select2').select2('destroy');
  }
});

$(document).on('turbolinks:load', function() {
  var controller = $('body').data('controller');
  var action = $('body').data('action');

  $('.kurumesi_order_select_product.select2').select2();
  $('.add_kurumesi_order_detail').on('click',function(){
    $('.kurumesi_order_select_product.select2').select2('destroy');
    setTimeout(function(){
      $('.kurumesi_order_select_product.select2').select2();
    },5);
  });

  $("#kurumesi_order_details_area").on('keyup','.kurumesi_order_details_product_number', function(){
    calculate_num();
  });

  $("#kurumesi_order_details_area").on('click','.remove_fields', function(){
    setTimeout(function(){
      calculate_num();
    },5);
  });
  function calculate_num(){
    var sum = 0;
    $('.kurumesi_order_details_tr:visible').each(function(i){
      sum += Number($(this).find('.kurumesi_order_details_product_number').val());
    });
    $('.kurumesi_order_sum_number').val(sum);
  }


})
function kanma (number) {
  var number = parseFloat(number);
  var number1 = number * 100;
  // //四捨五入したあと、小数点の位置を元に戻す
  number1 = Math.round(number1) / 100;
  var numData = number1.toString().split('.');
  // 整数部分を3桁カンマ区切りへ
  numData[0] = Number(numData[0]).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
  // 小数部分と結合して返却
  return numData.join('.');
};
